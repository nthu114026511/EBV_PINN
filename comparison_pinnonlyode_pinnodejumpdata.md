---
marp: true
theme: default
paginate: true
math: katex
backgroundColor: #fff
style: |
  section {
    font-size: 22px;
    padding: 50px;
  }
  h1 {
    color: #2563eb;
    font-size: 36px;
    margin-bottom: 20px;
  }
  h2 {
    color: #1e40af;
    font-size: 28px;
    margin-top: 15px;
    margin-bottom: 15px;
  }
  h3 {
    color: #3b82f6;
    font-size: 24px;
  }
  table {
    font-size: 18px;
  }
  code {
    background: #f3f4f6;
    font-size: 16px;
  }
  img {
    display: block;
    margin: 20px auto;
  }
  ul, ol {
    font-size: 20px;
  }
  .katex {
    font-size: 0.9em;
  }
---

# PINN è¨“ç·´æ–¹æ³•æ¯”è¼ƒ
## ç´” ODE ç´„æŸ vs. ODE + æ•¸æ“šç´„æŸ

EBV (Epstein-Barr Virus) æ¨¡å‹çš„å…©ç¨®è¨“ç·´ç­–ç•¥

---

# çµæœæ¯”è¼ƒ

<style scoped>
  section {
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  .comparison-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
    align-items: start;
  }
  .comparison-item {
    display: flex;
    flex-direction: column;
  }
  .comparison-item h2 {
    font-size: 24px;
    text-align: center;
    margin-bottom: 10px;
  }
  .comparison-item img {
    width: 100%;
    height: auto;
  }
  .comparison-item ul {
    font-size: 18px;
    margin-top: 10px;
  }
</style>

<div class="comparison-container">

<div class="comparison-item">

## æ–¹æ³• 1: ç´” ODE ç´„æŸ

![](pinn_only_ode/outputs/PINN_vs_exactsolution_final/BRE_comparison.png)

- åƒ…ä½¿ç”¨ç‰©ç†æ–¹ç¨‹å¼ç´„æŸ
- èˆ‡è§£æè§£æ¯”è¼ƒ

</div>

<div class="comparison-item">

## æ–¹æ³• 2: ODE + æ•¸æ“šç´„æŸ

![](pinn_ode_jumpdata/outputs/add_data_loss/BRE_comparison.png)

- ç‰©ç†æ–¹ç¨‹å¼ + CSV æ•¸æ“š
- èˆ‡ MATLAB RK4 ï¼ˆæœ‰jumpï¼‰æ•¸æ“šæ¯”è¼ƒ

</div>

</div>

---

# æ•¸æ“šä¾†æºèªªæ˜

## evb_training_data.csv æ•¸æ“šä¾†æº

### MATLAB RK4 (Runge-Kutta 4th order) æ•¸å€¼è§£

```matlab
% å¾®åˆ†æ–¹ç¨‹ç³»çµ±
B' = r*B*(1 - B/K)        % è…«ç˜¤ç´°èƒæˆé•· (Logistic model)
R' = sigma0*B - k12*R     % æ”¾å°„èª˜å°è›‹ç™½è³ªç”¢ç”Ÿ
E' = k12*R - kc*E         % æ•ˆæ‡‰è›‹ç™½è³ªæ´»åŒ–
```

- **æ•¸å€¼æ–¹æ³•**: 4éš Runge-Kutta (RK4)
- **æ™‚é–“ç¯„åœ**: t âˆˆ [0, 60]
- **æ­¥é•·**: h = 0.1
- **è¼¸å‡º**: æ™‚é–“åºåˆ—æ•¸æ“š (t, B, R, E)

ğŸ“ **æ­¤æ•¸æ“šè¢«è¦–ç‚ºã€Œé«˜ç²¾åº¦æ•¸å€¼è§£ã€ï¼Œç”¨æ–¼è¨“ç·´ç¬¬äºŒå€‹ PINN æ¨¡å‹**

---

# æ¨¡å‹æ¶æ§‹æ¯”è¼ƒ

## å…±åŒæ¶æ§‹è¨­å®š

| åƒæ•¸ | è¨­å®šå€¼ |
|------|--------|
| ç¶²çµ¡é¡å‹ | Fully Connected Neural Network |
| éš±è—å±¤æ•¸ | 6 å±¤ |
| æ¯å±¤ç¥ç¶“å…ƒæ•¸ | 512 |
| å„ªåŒ–å™¨ | Adam |
| å­¸ç¿’ç‡èª¿åº¦ | TF Exponential (decay_rate=0.95) |
| è¨“ç·´æ­¥æ•¸ | 10,000 |
| è¼¸å…¥ | x âˆˆ [0, 1] (ç¸®æ”¾æ™‚é–“) |
| è¼¸å‡º | B(x), R(x), E(x) |

---

# ç‰©ç†åƒæ•¸è¨­å®š

## çµ±ä¸€ç‰©ç†åƒæ•¸

| åƒæ•¸ | ç¬¦è™Ÿ | æ•¸å€¼ | èªªæ˜ |
|------|------|------|------|
| æˆé•·ç‡ | r | 0.10 | è…«ç˜¤ç´°èƒæˆé•·é€Ÿç‡ |
| æ‰¿è¼‰é‡ | K | 5.0 | ç’°å¢ƒæ‰¿è¼‰å®¹é‡ |
| Bâ†’R è½‰æ›ç‡ | Ïƒâ‚€ | 0.01 | B ç´°èƒè½‰æˆ R è›‹ç™½é€Ÿç‡ |
| Râ†’E è½‰æ›ç‡ | kâ‚â‚‚ | 0.05 | R è›‹ç™½è½‰æˆ E è›‹ç™½é€Ÿç‡ |
| E è¡°æ¸›ç‡ | kc | 0.15 | E è›‹ç™½è¡°æ¸›é€Ÿç‡ |
| åˆå§‹æ¢ä»¶ | Bâ‚€, Râ‚€, Eâ‚€ | 0.05, 0.0, 0.0 | åˆå§‹ç‹€æ…‹ |
| æ™‚é–“ç¯„åœ | [tâ‚€, tf] | [0, 60] | åŸå§‹æ™‚é–“å°ºåº¦ |

---

# Batch Size é…ç½®æ¯”è¼ƒ

## æ¡æ¨£é»æ•¸å·®ç•°

| Constraint | æ–¹æ³• 1: ç´” ODE | æ–¹æ³• 2: ODE + æ•¸æ“š |
|------------|----------------|-------------------|
| **åˆå§‹æ¢ä»¶ (IC)** | 600 | 600 |
| **å…§éƒ¨é» (Interior)** | 6,000 | 6,000 |
| â””â”€ å‰æœŸ (x < 0.3) | 4,200 (70%) | 4,200 (70%) |
| â””â”€ å¾ŒæœŸ (x â‰¥ 0.3) | 1,800 (30%) | 1,800 (30%) |
| **æ•¸æ“šé» (Data)** | âŒ ç„¡ | âœ… **64 (æ–°å¢)** |

ğŸ’¡ **é—œéµå·®ç•°**: æ–¹æ³• 2 é¡å¤–ä½¿ç”¨ CSV æ•¸æ“šé€²è¡Œè¨“ç·´

---

# ğŸ”´ **æ ¸å¿ƒå·®ç•°: åå‘å‚³æ’­çš„ Loss å‡½æ•¸**

## æ–¹æ³• 1: ç´” ODE ç´„æŸ (3 å€‹ Loss é …)

$$\mathcal{L}_{\text{total}} = \mathcal{L}_{\text{IC}} + \mathcal{L}_{\text{ODE}}$$

**è©³ç´°çµ„æˆ:**

åˆå§‹æ¢ä»¶ Loss:
$$\mathcal{L}_{\text{IC}} = 100 \cdot |B(0) - B_0|^2 + 100 \cdot |R(0) - R_0|^2 + 100 \cdot |E(0) - E_0|^2$$

ODE æ®˜å·® Loss:
$$\mathcal{L}_{\text{ODE}} = \sum_{x_i \in \Omega} \left[ \lambda_B \cdot r_B^2(x_i) + \lambda_R \cdot r_R^2(x_i) + \lambda_E \cdot r_E^2(x_i) \right]$$

**æ¬Šé‡è¨­å®š:**
- åˆå§‹æ¢ä»¶: Î»_IC = 100
- ODE æ®˜å·®: Î»_B = 1.0, Î»_R = 5.0, Î»_E = 5.0

---

# ğŸ”´ Loss å‡½æ•¸å·®ç•° (çºŒ)

## æ–¹æ³• 2: ODE + æ•¸æ“šç´„æŸ (4 å€‹ Loss é …)

$$\mathcal{L}_{\text{total}} = \mathcal{L}_{\text{IC}} + \mathcal{L}_{\text{ODE}} + \mathcal{L}_{\text{Data}}$$

**â­ æ–°å¢æ•¸æ“š Loss:**

$$\mathcal{L}_{\text{Data}} = \sum_{i=1}^{N_{\text{data}}} \left[ \lambda_{B} \cdot |B(x_i) - B_{\text{CSV}}(x_i)|^2 + \lambda_{R} \cdot |R(x_i) - R_{\text{CSV}}(x_i)|^2 + \lambda_{E} \cdot |E(x_i) - E_{\text{CSV}}(x_i)|^2 \right]$$

**æ¬Šé‡è¨­å®š:**
- æ•¸æ“šæ“¬åˆ: Î»_B,data = 10.0, Î»_R,data = 10.0, Î»_E,data = 10.0

ğŸ’¡ **é—œéµ:** æ•¸æ“šç´„æŸåƒèˆ‡æ¢¯åº¦ä¸‹é™ï¼Œå¼•å°ç¶²çµ¡å¿«é€Ÿæ”¶æ–‚

---

# ODE æ®˜å·®è¨ˆç®—

## ç›¸å°æ®˜å·®å½¢å¼ (é¿å…çµ•å°å€¼æ¢¯åº¦å•é¡Œ)

**B è®Šæ•¸æ®˜å·®:**
$$r_B = \frac{B'(x) - \text{time\_scale} \cdot r \cdot B \cdot (1 - B/K)}{\sqrt{B^2 + (\epsilon \cdot B_{\text{scale}})^2}}$$

**R è®Šæ•¸æ®˜å·®:**
$$r_R = \frac{R'(x) - \text{time\_scale} \cdot (\sigma_0 \cdot B - k_{12} \cdot R)}{\sqrt{R^2 + (\epsilon \cdot R_{\text{scale}})^2 + R_{\text{scale}}^2}}$$

**E è®Šæ•¸æ®˜å·®:**
$$r_E = \frac{E'(x) - \text{time\_scale} \cdot (k_{12} \cdot R - k_c \cdot E)}{\sqrt{E^2 + (\epsilon \cdot E_{\text{scale}})^2 + E_{\text{scale}}^2}}$$

---

# åå‘å‚³æ’­éç¨‹æ¯”è¼ƒ

## æ–¹æ³• 1: ç´”ç‰©ç†é©…å‹•

```python
# æ¢¯åº¦è¨ˆç®—åƒ…ä¾†è‡ªç‰©ç†ç´„æŸ
âˆ‡Î¸ L_total = âˆ‡Î¸ (L_IC + L_ODE)

# ç‰¹é»ï¼š
# âœ“ ä¸éœ€è¦å¤–éƒ¨æ•¸æ“š
# âœ“ å®Œå…¨ä¾è³´ç‰©ç†æ–¹ç¨‹å¼
# âœ— å¯èƒ½å­˜åœ¨å¤šå€‹å±€éƒ¨æœ€å„ªè§£
# âœ— å°åˆå§‹åŒ–æ•æ„Ÿ
```

## æ–¹æ³• 2: ç‰©ç† + æ•¸æ“šé©…å‹•

```python
# æ¢¯åº¦è¨ˆç®—åŒ…å«æ•¸æ“šæ“¬åˆé …
âˆ‡Î¸ L_total = âˆ‡Î¸ (L_IC + L_ODE + L_Data)

# ç‰¹é»ï¼š
# âœ“ æ•¸æ“šå¼•å°ç¶²çµ¡æ”¶æ–‚æ–¹å‘
# âœ“ æ¸›å°‘ä¸ç¢ºå®šæ€§
# âœ“ æé«˜æ•¸å€¼ç²¾åº¦
# âœ— ä¾è³´å¤–éƒ¨æ•¸æ“šè³ªé‡
```

---

# æ¡æ¨£ç­–ç•¥æ¯”è¼ƒ

## å…§éƒ¨é»æ¡æ¨£ (å…©ç¨®æ–¹æ³•ç›¸åŒ)

**æ™‚é–“åˆ†æ®µæ¡æ¨£** - é‡å°å‹•æ…‹ç‰¹æ€§å„ªåŒ–:

| å€åŸŸ | æ¢ä»¶ | æ¡æ¨£æ¯”ä¾‹ | ç›®çš„ |
|------|------|----------|------|
| å‰æœŸ | x < 0.3 | 70% (4200 é») | æ•æ‰å¿«é€Ÿè®ŠåŒ– |
| å¾ŒæœŸ | x â‰¥ 0.3 | 30% (1800 é») | ç©©æ…‹è¡Œç‚º |

**ç‚ºä»€éº¼åé‡å‰æœŸ?**
- B, R, E åœ¨åˆæœŸè®ŠåŒ–æœ€åŠ‡çƒˆ
- ODE æ®˜å·®åœ¨æ­¤éšæ®µæœ€å¤§
- éœ€è¦æ›´å¤šæ¡æ¨£é»ä¾†æº–ç¢ºæ•æ‰å‹•æ…‹

---

# Lambda æ¬Šé‡è¨­å®šå“²å­¸

## æ¬Šé‡é¸æ“‡çš„ç‰©ç†æ„ç¾©

| Loss é … | Î» å€¼ | ç†ç”± |
|---------|------|------|
| IC (åˆå§‹æ¢ä»¶) | 100 | **å¿…é ˆåš´æ ¼æ»¿è¶³** - ç‰©ç†ç³»çµ±èµ·é» |
| ODE_B | 1.0 | B è®ŠåŒ–æœ€å¤§ï¼Œæ®˜å·®å¤©ç„¶è¼ƒå¤§ |
| ODE_R | 5.0 | R è®ŠåŒ–è¼ƒå°ï¼Œæé«˜æ¬Šé‡å¹³è¡¡ loss |
| ODE_E | 5.0 | E è®ŠåŒ–æœ€å°ï¼Œæé«˜æ¬Šé‡å¹³è¡¡ loss |
| Data_B/R/E | 10.0 | å¼•å°æ”¶æ–‚æ–¹å‘ï¼Œä½†ä¸éåº¦ç´„æŸ |

**è¨­è¨ˆåŸå‰‡:**
1. IC æ¬Šé‡æœ€é«˜ â†’ ç¢ºä¿æ­£ç¢ºçš„èµ·å§‹ç‹€æ…‹
2. è®Šæ•¸æ¬Šé‡åæ¯”æ–¼å…¶å…¸å‹è®ŠåŒ–ç¯„åœ â†’ å¹³è¡¡ä¸åŒè®Šæ•¸çš„ loss è²¢ç»
3. æ•¸æ“šæ¬Šé‡é©ä¸­ â†’ æ—¢å¼•å°è¨“ç·´ï¼Œåˆä¿æŒç‰©ç†ä¸€è‡´æ€§

---

# è¨“ç·´æ•ˆç‡æ¯”è¼ƒ

## æ”¶æ–‚ç‰¹æ€§

| ç‰¹æ€§ | æ–¹æ³• 1: ç´” ODE | æ–¹æ³• 2: ODE + æ•¸æ“š |
|------|----------------|-------------------|
| è¨“ç·´ç©©å®šæ€§ | ä¸­ç­‰ | è¼ƒé«˜ âœ“ |
| æ”¶æ–‚é€Ÿåº¦ | è¼ƒæ…¢ | è¼ƒå¿« âœ“ |
| è§£çš„å”¯ä¸€æ€§ | å¯èƒ½å¤šè§£ | æ›´å”¯ä¸€ âœ“ |
| åˆå€¼æ•æ„Ÿåº¦ | è¼ƒé«˜ | è¼ƒä½ âœ“ |
| å¤–æ¨èƒ½åŠ› | ä¾è³´ç‰©ç† | æœ‰é™ |
| æ•¸æ“šä¾è³´ | ç„¡ âœ“ | é«˜ |

**çµè«–:**
- **æ–¹æ³• 1** é©åˆ: å·²çŸ¥ç²¾ç¢ºç‰©ç†å®šå¾‹ï¼Œç„¡å¯é æ•¸æ“š
- **æ–¹æ³• 2** é©åˆ: æœ‰é«˜è³ªé‡æ•¸æ“šï¼Œå¸Œæœ›å¿«é€Ÿæº–ç¢ºæ”¶æ–‚

---

# æ¢¯åº¦æµåˆ†æ

## åå‘å‚³æ’­çš„æ¢¯åº¦ä¾†æº

### æ–¹æ³• 1: ç´” ODE
```
Input x â†’ Network(Î¸) â†’ [B, R, E]
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                    â†“             â†“
            Compute B', R', E'   Check IC
                    â†“             â†“
            ODE Residuals    IC Residuals
                    â†“             â†“
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                   L_total (3 é …)
                           â†“
                    âˆ‚L/âˆ‚Î¸ (æ¢¯åº¦)
```

---

# æ¢¯åº¦æµåˆ†æ (çºŒ)

## æ–¹æ³• 2: ODE + æ•¸æ“š

```
Input x â†’ Network(Î¸) â†’ [B, R, E]
                           â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â†“              â†“              â†“
    Compute B',R',E'   Check IC   Compare with CSV
            â†“              â†“              â†“
    ODE Residuals   IC Residuals   Data Residuals
            â†“              â†“              â†“
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                   L_total (4 é …) â† å¤šä¸€å€‹æ•¸æ“šé …!
                           â†“
                    âˆ‚L/âˆ‚Î¸ (æ¢¯åº¦æ›´è±å¯Œ)
```

**é—œéµ:** æ•¸æ“šé …æä¾›é¡å¤–çš„æ¢¯åº¦ä¿¡æ¯ï¼Œå¹«åŠ©ç¶²çµ¡å¿«é€Ÿæ‰¾åˆ°æ­£ç¢ºçš„è§£ç©ºé–“

---

# æ™‚é–“ç¸®æ”¾æŠ€è¡“

## ç‚ºä»€éº¼éœ€è¦æ™‚é–“ç¸®æ”¾?

**åŸå§‹æ™‚é–“**: t âˆˆ [0, 60]  
**ç¸®æ”¾æ™‚é–“**: x âˆˆ [0, 1]

è½‰æ›å…¬å¼:
$$x = \frac{t - t_0}{t_f - t_0}$$

å°æ•¸è½‰æ›:
$$\frac{dB}{dx} = (t_f - t_0) \cdot \frac{dB}{dt}$$

**å„ªé»:**
- âœ… ç¶²çµ¡è¼¸å…¥æ­¸ä¸€åŒ– â†’ è¨“ç·´æ›´ç©©å®š
- âœ… é¿å…å¤§å°æ•¸å€¼æ··åˆ â†’ æ¸›å°‘æ•¸å€¼èª¤å·®
- âœ… æ¢¯åº¦æ›´å‡å‹»åˆ†å¸ƒ

---

# ç›¸å°æ®˜å·®çš„é‡è¦æ€§

## ç‚ºä»€éº¼ä½¿ç”¨ç›¸å°æ®˜å·®?

**å•é¡Œ:** B, R, E çš„æ•¸é‡ç´šå·®ç•°å¤§
- B ~ O(5)
- R ~ O(1)  
- E ~ O(0.3)

**è§£æ±ºæ–¹æ¡ˆ:** æ­¸ä¸€åŒ–æ®˜å·®

$$
r_i = \frac{\text{çµ•å°æ®˜å·®}}{\text{å…¸å‹å°ºåº¦}} = \frac{|f_i|}{\sqrt{y_i^2 + \text{scale}_i^2}}
$$

**æ•ˆæœ:**
- âœ… ä¸åŒè®Šæ•¸çš„ loss è²¢ç»å¹³è¡¡
- âœ… é¿å…å¤§è®Šæ•¸ä¸»å°è¨“ç·´
- âœ… å°è®Šæ•¸ä¹Ÿèƒ½è¢«æº–ç¢ºå­¸ç¿’

---

# CSV æ•¸æ“šåœ¨è¨“ç·´ä¸­çš„ä½œç”¨

## æ•¸æ“šç´„æŸ vs. é©—è­‰å™¨

### å…©ç¨®æ–¹æ³•éƒ½æœ‰ CSV æ•¸æ“šï¼Œä½†ç”¨é€”ä¸åŒ:

| ç”¨é€” | æ–¹æ³• 1 | æ–¹æ³• 2 |
|------|--------|--------|
| **è¨“ç·´ç´„æŸ** (åƒèˆ‡æ¢¯åº¦) | âŒ | âœ… 64 é»/batch |
| **é©—è­‰å™¨** (åƒ…ç›£æ§) | âœ… 10000 é» | âœ… å…¨éƒ¨é» |

**æ–¹æ³• 2 çš„å‰µæ–°:**
```python
# æ•¸æ“šè¢«åŠ å…¥ç‚ºè¨“ç·´ç´„æŸ
data_constraint = PointwiseConstraint(
    dataset=DictPointwiseDataset(invar, outvar, lambda_weighting),
    batch_size=64,  # æ¯æ¬¡è¿­ä»£æ¡æ¨£ 64 å€‹æ•¸æ“šé»
)
domain.add_constraint(data_constraint, "data_constraint")
```

â†’ **æ¯å€‹è¨“ç·´æ­¥é©Ÿéƒ½æœƒè¨ˆç®—æ•¸æ“šæ“¬åˆ loss ä¸¦åå‘å‚³æ’­**

---

# æå¤±å‡½æ•¸æ¢¯åº¦æ¨å°

## æ–¹æ³• 1 çš„æ¢¯åº¦

$$\frac{\partial \mathcal{L}_{\text{total}}}{\partial \theta} = \frac{\partial \mathcal{L}_{\text{IC}}}{\partial \theta} + \frac{\partial \mathcal{L}_{\text{ODE}}}{\partial \theta}$$

**æ¢¯åº¦ä¾†æº:** åˆå§‹æ¢ä»¶èª¤å·® + å¾®åˆ†æ–¹ç¨‹æ®˜å·®

---

## æ–¹æ³• 2 çš„æ¢¯åº¦

$$\frac{\partial \mathcal{L}_{\text{total}}}{\partial \theta} = \frac{\partial \mathcal{L}_{\text{IC}}}{\partial \theta} + \frac{\partial \mathcal{L}_{\text{ODE}}}{\partial \theta} + \frac{\partial \mathcal{L}_{\text{Data}}}{\partial \theta}$$

**é¡å¤–çš„æ•¸æ“šæ¢¯åº¦:**
$$\frac{\partial \mathcal{L}_{\text{Data}}}{\partial \theta} = \sum_{i} 2\lambda \cdot (NN_\theta(x_i) - y_{\text{CSV},i}) \cdot \frac{\partial NN_\theta(x_i)}{\partial \theta}$$

ğŸ’¡ **é—œéµ:** æ•¸æ“šæ¢¯åº¦å¼•å°ç¶²çµ¡æœæ­£ç¢ºè§£æ”¶æ–‚

---

# ç¸½çµ: å…©ç¨®æ–¹æ³•çš„é©ç”¨å ´æ™¯

## æ–¹æ³• 1: ç´” ODE ç´„æŸ

**é©ç”¨æƒ…æ³:**
- âœ… ç‰©ç†å®šå¾‹å®Œå…¨å·²çŸ¥ä¸”ç²¾ç¢º
- âœ… ç„¡å¯ç”¨è§€æ¸¬æ•¸æ“šæˆ–æ•¸æ“šä¸å¯ä¿¡
- âœ… éœ€è¦ç‰©ç†ä¸€è‡´æ€§å¤–æ¨
- âœ… ç ”ç©¶ç‰©ç†ç³»çµ±çš„ç†è«–æ€§è³ª

**ä¾·é™:**
- âš ï¸ è¨“ç·´å¯èƒ½ä¸ç©©å®š
- âš ï¸ éœ€è¦ä»”ç´°èª¿æ•´è¶…åƒæ•¸
- âš ï¸ æ”¶æ–‚è¼ƒæ…¢

---

# ç¸½çµ: å…©ç¨®æ–¹æ³•çš„é©ç”¨å ´æ™¯ (çºŒ)

## æ–¹æ³• 2: ODE + æ•¸æ“šç´„æŸ

**é©ç”¨æƒ…æ³:**
- âœ… æœ‰é«˜è³ªé‡æ•¸å€¼/å¯¦é©—æ•¸æ“š
- âœ… å¸Œæœ›å¿«é€Ÿæº–ç¢ºæ”¶æ–‚
- âœ… æ•¸æ“šç¯„åœå…§çš„é æ¸¬
- âœ… ç‰©ç†æ¨¡å‹ + è§€æ¸¬æ•¸æ“šèåˆ

**ä¾·é™:**
- âš ï¸ ä¾è³´æ•¸æ“šè³ªé‡
- âš ï¸ å¤–æ¨èƒ½åŠ›å—é™
- âš ï¸ å¯èƒ½éåº¦æ“¬åˆæ•¸æ“š

---

# é—œéµçµè«–

## ğŸ¯ åå‘å‚³æ’­ Loss çš„æ ¸å¿ƒå·®ç•°

1. **Loss é …æ•¸é‡**: æ–¹æ³• 1 (3 é …) vs. æ–¹æ³• 2 (4 é …)
2. **æ¢¯åº¦ä¾†æº**: æ–¹æ³• 2 é¡å¤–åŒ…å«æ•¸æ“šæ“¬åˆæ¢¯åº¦
3. **è¨“ç·´å°å‘**: 
   - æ–¹æ³• 1: ç‰©ç†å®šå¾‹é©…å‹•
   - æ–¹æ³• 2: ç‰©ç†å®šå¾‹ + æ•¸æ“šé›™é‡é©…å‹•

## ğŸ”¬ æ•¸æ“šä¾†æº

- **evb_training_data.csv** ç”± MATLAB RK4 æ•¸å€¼æ–¹æ³•ç”Ÿæˆ
- æ™‚é–“ç¯„åœ [0, 60]ï¼Œæ­¥é•· h = 0.1
- æä¾›é«˜ç²¾åº¦åƒè€ƒè§£ç”¨æ–¼è¨“ç·´/é©—è­‰

---

# é™„éŒ„: ç¨‹å¼ç¢¼å°æ¯”

## Loss è¨ˆç®—çš„é—œéµå·®ç•°

### æ–¹æ³• 1 (ç´” ODE):
```python
# åªæœ‰ ODE å’Œ IC ç´„æŸ
IC = PointwiseBoundaryConstraint(...)
interior_early = PointwiseInteriorConstraint(...)  # ODE residual
interior_late = PointwiseInteriorConstraint(...)   # ODE residual
```

### æ–¹æ³• 2 (ODE + æ•¸æ“š):
```python
# é™¤äº† ODE å’Œ ICï¼Œé‚„æœ‰æ•¸æ“šç´„æŸ
IC = PointwiseBoundaryConstraint(...)
interior_early = PointwiseInteriorConstraint(...)
interior_late = PointwiseInteriorConstraint(...)
data_constraint = PointwiseConstraint(...)  # â† æ–°å¢! åƒèˆ‡è¨“ç·´
```